<!--
  Licenses Page | Cannlytics
  Created: 2/25/2024
  Updated: 9/30/2024
-->
{% extends "components/layout/dashboard.html" %}
{% load static %}
{% block title %}
  {% if section and section not in 'logs,files,certificates' %}
    {{ section }} | Cannlytics
  {% else %}
    Licensees | Cannlytics
  {% endif %}
{% endblock %}
{% block dashboard_css %}

  <!-- AG Grid -->
  <script src="https://unpkg.com/ag-grid-community/dist/ag-grid-community.min.noStyle.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/ag-grid-community/styles/ag-grid.css"/>
  <link rel="stylesheet" href="https://unpkg.com/ag-grid-community/styles/ag-theme-quartz.css"/>
  <script src="https://unpkg.com/ag-grid-community/dist/ag-grid-community.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css">
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;700&display=swap" rel="stylesheet" />

  <!-- Masonry -->
  <script src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha384-GNFwBvfVxBkLMJpYMOABq3c+d3KnQxudP/mGPkzpZSTYykLBNsZEnG2D9G/X/+7D" crossorigin="anonymous" async></script>

  <!-- Bootstrap Datepicker -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css" integrity="sha512-mSYUmp1HYZDFaVKK//63EcZq4iFWFjxSL+Z3T/aCt4IO9Cejm03q3NKKYN6pFQzY0SBOr8h+eCIAZHPXcpZaNw==" crossorigin="anonymous" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js" integrity="sha512-T/tUfKSV1bihCnd+MxKD0Hm1uBBroVYBOYSk1knyvQ9VyZJpc/ALb4P0r6ubwVPSGB2GvjeoMAJJImBG12TiaQ==" crossorigin="anonymous"></script>

{% endblock %}
{% block dashboard %}
{% if section and section not in 'logs,files,certificates' %}

  <!-- Licensee page -->
  {% include "pages/licenses/license.html" with
    id=section
  %}

{% else %}

<!-- Licensees page -->
<section class="container markdown">

  <h1>Organizations</h1>

  <!-- Filters -->
  <div class="selections-container align-items-center">

    <!-- State selection buttons -->
    {% include "components/forms/state_selection.html" %}

  </div>

  <!-- List/Grid View -->
  <div class="btn-group btn-group-sm" role="group" aria-label="View selection">
    <button type="button" class="btn btn-primary" id="gridViewButton" onclick="cannlytics.licenses.renderGridView()">
      <i class="bi bi-grid"></i> Grid
    </button>
    <button type="button" class="btn btn-outline-primary" id="listViewButton" onclick="cannlytics.licenses.renderListView()">
      <i class="bi bi-list"></i> List
    </button>
  </div>

  <!-- Licensees List/Grid -->
  <div
    id="licenseesContainer"
    class="mt-3 row ag-theme-quartz ag-theme-quartz-dark"
    data-masonry='{"percentPosition": true }'
    style="height: 100vh;"
  ></div>

</section>
{% endif %}
{% endblock %}

{% block page_js %}
{% if section and section not in 'logs,files,certificates' %}
  <script>
    // Initialize licensee. 
    cannlytics.licenses.initializeLicensee();
  </script>
{% else %}
  <script>
    // Attach functionality.
    document.getElementById('searchInput').addEventListener('input', function() {
      cannlytics.licenses.initializeLicensees();
    });

    // JavaScript function to handle state selection
    function updateStateSelection(selectedState) {
      document.querySelectorAll('.btn-group .btn').forEach(function(btn) {
        btn.classList.remove('btn-primary');
        btn.classList.add('btn-outline-primary');
      });
      document.getElementById('btn' + selectedState).classList.remove('btn-outline-primary');
      document.getElementById('btn' + selectedState).classList.add('btn-primary');
      cannlytics.licenses.initializeLicensees();
    }

    // Initialize licensees. 
    cannlytics.licenses.initializeLicensees();
  </script>
{% endif %}
{% endblock %}
