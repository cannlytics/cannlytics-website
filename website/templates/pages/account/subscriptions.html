<!--
  Subscription Management Page | Cannlytics Website
  Copyright (c) 2021-2024 Cannlytics

  Authors: Keegan Skeate <https://github.com/keeganskeate>
  Created: 11/16/2021
  Updated: 9/23/2024
  License: MIT License <https://github.com/cannlytics/cannlytics-website/blob/main/LICENSE>
-->
{% extends "components/layout/dashboard.html" %}
{% load static %}
{% block title %}Subscription | Cannlytics{% endblock %}
{% block dashboard_css %}

  <!-- Minor Style Adjustments -->
  <style>
    .tooltip-inner {
      text-align: left;
    }
    .bg-purple {
      background-color: #7B4EA8 !important;
    }
    .bg-orange {
      background-color: #FF7F00 !important;
    }
    .bg-green {
      background-color: #16c995 !important;
    }
    .btn-purple {
      background-color: #7B4EA8 !important;
      color: white;
    }
    .btn-orange {
      background-color: #FF7F00 !important;
      color: white;
    }
    .btn-green {
      background-color: #16c995 !important;
      color: white;
    }
    .selected-subscription {
      border: 2px solid #16c995;
    }
  </style>

  <!-- PayPal Subscriptions JavaScript -->
  <script src="https://www.paypal.com/sdk/js?client-id={{ paypal.client_id }}&vault=true&intent=subscription" data-sdk-integration-source="button-factory"></script>

{% endblock %}
{% block dashboard %}

  <!-- Subscription Management -->
  <section class=" container mb-2">

    <!-- Breadcrumbs -->
    {% include "components/layout/breadcrumbs.html" with
      base_page="Account"
      base_page_url="/account"
      current_page="Subscriptions"
    %}

    <!-- Subscriptions -->
    <div class="mt-3">
      <h1 class="pt-4 text-dark sans-serif">Cannlytics Subscriptions</h1>
      <p class="mt-2 mb-4 sans-serif" style="max-width:560px;">
        With your Cannlytics subscription, you'll get access to:
      </p>
      <div class="markdown row">
        <!-- Feature List -->
        <div class="col-4">
          <div class="list-group" id="list-tab" role="tablist">
            <a class="list-group-item list-group-item-action active" id="list-coa-list" data-bs-toggle="list" href="#list-coa" role="tab" aria-controls="list-coa">
              COA Parser
            </a>
            <a class="list-group-item list-group-item-action" id="list-receipt-list" data-bs-toggle="list" href="#list-receipt" role="tab" aria-controls="list-receipt">
              Receipt &amp; Label Parser
            </a>
            <a class="list-group-item list-group-item-action" id="list-archives-list" data-bs-toggle="list" href="#list-archives" role="tab" aria-controls="list-archives">
              Data Archives
            </a>
            <a class="list-group-item list-group-item-action" id="list-api-list" data-bs-toggle="list" href="#list-api" role="tab" aria-controls="list-api">
              API Access
            </a>
          </div>
        </div>
      
        <!-- Feature Descriptions -->
        <div class="col-8">
          <div class="tab-content" id="nav-tabContent">
            <!-- COA Parser -->
            <div class="tab-pane fade show active" id="list-coa" role="tabpanel" aria-labelledby="list-coa-list">
              <h3 class="mt-0 sans-serif">COA Parser</h3>
              <p class="sans-serif-text">Certificates of analysis (COAs) are abundant for cultivators, processors, retailers, and consumers too, but the data is often locked away. Rich, valuable laboratory data so close, yet so far away! User our COA parser, <b>CoADoc</b> to get these data points in your hands by parsing PDFs and URLs and cleanly returning the data to you.</p>
            </div>
      
            <!-- Receipt Parser -->
            <div class="tab-pane fade" id="list-receipt" role="tabpanel" aria-labelledby="list-receipt-list">
              <h3 class="mt-0 sans-serif">Label &amp; Receipt Parser</h3>
              <p class="sans-serif-text">Your cannabis package labels and receipts hold a lot of data. Put that data to work with <b>BudSpender</b>. This OpenAI-powered tool parses cannabis labels and receipts into well-structured data that can be used for trending, analytics, and however you please.</p>
            </div>
      
            <!-- Data Archives -->
            <div class="tab-pane fade" id="list-archives" role="tabpanel" aria-labelledby="list-archives-list">
              <h3 class="mt-0 sans-serif">Data Archives</h3>
              <p class="sans-serif-text">
                You'll get access to our repository of
                public cannabis lab test results obtained through public records requests and certificates of analysis (COAs) available online. Lab results are useful for cannabis cultivators, processors, retailers, consumers, and everyone else too.</p>
            </div>
      
            <!-- API Access -->
            <div class="tab-pane fade" id="list-api" role="tabpanel" aria-labelledby="list-api-list">
              <h3 class="mt-0 sans-serif">API Access</h3>
              <p class="sans-serif-text">The Cannlytics API allows users to interface with cannabis data and statistics. Each API endpoint handles authentication, error handling, and identifying the precise logic to perform. You can perform all of your favorite
              parsing programmatically with the API.</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Tiers -->
      <h1 class="mt-5 pt-4 text-dark sans-serif">Pricing</h1>
      <p class="mt-2 mb-0 sans-serif" style="max-width:560px;">
        We want it to be affordable for you to access all of the cannabis data that you need.
      </p>
      <div class="row row-cols-1 row-cols-md-3 mb-3 mt-3 text-center">
        {% for item in subscription_plans %}
          <div class="col-8 col-md-6 col-lg-4">
            <div id="subscription-card-{{ item.id }}" class="subscription-card card mb-4 shadow-sm">
              <div class="card-header bg-gradient-{{ item.color }}">
                <h4 class="fw-bold text-white my-0 sans-serif">
                  {{ item.name }}
                </h4>
              </div>
              <div class="card-body bg-transparent d-flex flex-column justify-content-between align-items-center">
                <h3 class="text-dark card-title pricing-card-title mt-3 mb-2 sans-serif-text">
                  {{ item.price }}
                </h3>
                <ul class="text-dark list-unstyled mt-3 mb-4 text-start w-75">
                  {% for attribute in item.attributes %}
                      <li class="fs-6 mb-2">
                        <svg class="" style="width:24px;height:24px;">
                          <use href="{% static "website/images/emojies/check.svg" %}#check-emoji"></use>
                        </svg>
                        <span class="sans-serif-text">{{ attribute }}</span>
                      </li>
                  {% endfor %}
                </ul>
                <div class="d-grid gap-2">
                  <a
                    id="subscribe-button-{{ item.id }}"
                    class="subscribe-button btn bg-gradient-{{ item.color }} text-white"
                    href="{% url 'section' page='account' section='checkout' %}?subscription='{{ item.id }}'"
                  >
                    Get {{ item.name }}
                  </a>
                  <button
                    id="cancel-button-{{ item.id }}"
                    class="cancel-button btn btn-sm-light btn-lg-light text-dark d-none"
                    data-bs-toggle="modal"
                    data-bs-target="#cancel-subscription-dialog"
                  >
                    Cancel
                  </button>
                </div>
              </div>
            </div>
          </div>
        {% endfor %}
      </div><!-- End of tiers -->

    </div><!-- End of support options -->

    <!-- Tokens-->
    {% comment %} {% include "pages/account/tokens.html" with user=user only%} {% endcomment %}

    <!-- Future work: Usage -->

    <!-- Historic Lab Result Migration -->
    <div class="container mb-5 mt-5">
      <div class="py-5" style="max-width:560px;">
        <svg class="pt-3 pe-3" style="float:left;width:125px;height:125px;">
          <use href="{% static "website/images/emojies/sparkler.svg" %}#sparkler-emoji"></use>
        </svg>
        <h2 class="pt-4 text-dark serif-text">Standardize your data!</h2>
        <p class="mt-2">
          <small class="sans-serif-text">
            Your laboratory data are valuable to you and your clients,
            therefore, you can have us standardize your
            archive of lab results, in whatever format they may be in, into a clean,
            well-formatted, accessible workbook for you. Our standard rate is
            <strong>$500 per lab</strong> and <strong>50Â¢ per COA</strong>.
          </small>
        </p>
        <p class="text-start mt-3">
          <a
            class="btn bg-gradient-green text-white sans-serif"
            href="{% url 'page' page='support' %}?topic=data-migration"
          >
            Request a quote
            <i class="bi bi-arrow-right"></i>
          </a>
        </p>
      </div>
    </div>

    <!-- Consulting -->
    <div class="container mb-5 mt-3 pt-5">
      <div style="max-width:560px;">
        <svg class="pt-3 pe-3" style="float:left;width:125px;height:125px;">
          <use href="{% static "website/images/emojies/toolbox.svg" %}#toolbox-emoji"></use>
        </svg>
        <h2 class="pt-4 text-dark serif-text">Consulting &amp; Development</h2>
        <p class="mt-2">
          <small class="sans-serif-text">
          You can employ the Cannlytics team to help you solve any problems at hand.
          In general, the Cannlytics team is available for <strong>$500 per significant
          feature</strong> or for <strong>$42 per hour</strong>.
          We are always happy to talk and help you find your best-possible solution.
          </small>
        </p>
        <p class="text-start mt-3">
          <a
            class="btn bg-gradient-orange text-white sans-serif"
            href="{% url 'page' page='support' %}?topic=custom"
          >
            Request a job
            <i class="bi bi-arrow-right"></i>
          </a>
        </p>
      </div>
    </div>

    <!-- Metrc support -->
    <div class="my-5 pt-5">
      {% include "pages/homepage/components/metrc_state_list.html" with verifications=verifications only %}
    </div>

  </section>

  <!-- Cancel subscription dialog -->
  <!-- TODO: The font style may need to be fixed in this modal -->
  <div id="cancel-subscription-dialog" class="modal fade">
    <div class="modal-dialog">
      <div class="modal-content">

        <!-- Modal Header -->
        <div class="modal-header">
          <h4 class="modal-title">Cancel your subscription?</h4>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>

        <!-- Modal body -->
        <div class="modal-body">
          Are you sure that you want to cancel your subscription?
          If you do decide to cancel, then your tokens will still be valid
          until the end of your billing period.
          You may always subscribe again at any time.
        </div>

        <!-- Modal footer -->
        <div class="modal-footer">
          <button
            type="button"
            class="btn btn-sm-light btn-lg-light text-dark"
            data-bs-dismiss="modal"
          >
            Close
          </button>
          <button
            type="button"
            class="btn btn-danger"
            onclick="cannlytics.payments.cancelSubscription()"
          >
            Yes, cancel my subscription
          </button>
        </div>

      </div>
    </div>
  </div>

{% endblock %}

<!-- JavaScript -->
{% block page_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {

  // Initialize the interface with the user's current subscriptions.
  cannlytics.payments.initializeSubscriptions();

  // Enable tooltips.
  cannlytics.ui.enableTooltips();

});
</script>
{% endblock %}
